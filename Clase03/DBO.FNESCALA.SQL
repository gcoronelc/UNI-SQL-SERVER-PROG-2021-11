USE RH;
GO

ALTER FUNCTION DBO.FNESCALA( @SUELDO MONEY)
RETURNS VARCHAR(20)
AS
BEGIN
	-- VARIABLES
	DECLARE @ESCALA VARCHAR(20);
	-- PROCESO
	SET @ESCALA = CASE 
		WHEN @SUELDO>=0 AND @SUELDO<=2000 THEN 'BAJO'
		WHEN @SUELDO>2000 AND @SUELDO<=4500 THEN 'REGULAR'
		WHEN @SUELDO>4500 THEN 'BUENO'
		ELSE 'ERROR'
	END;
	-- REPORTE
	RETURN @ESCALA;
END;
GO


SELECT DBO.FNESCALA(500) ESCALA;
GO

SELECT idempleado, apellido, nombre, sueldo, DBO.FNESCALA(SUELDO) ESCALA
FROM empleado;
GO

